{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "5f5bff5e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>product_id</th>\n",
       "      <th>created_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>647746</td>\n",
       "      <td>2011564</td>\n",
       "      <td>2019-02-09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>906136</td>\n",
       "      <td>4105782</td>\n",
       "      <td>2019-11-23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>12862997</td>\n",
       "      <td>2144063</td>\n",
       "      <td>2019-07-16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12097079</td>\n",
       "      <td>1207738</td>\n",
       "      <td>2019-04-05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3184486</td>\n",
       "      <td>4278839</td>\n",
       "      <td>2019-03-08</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    user_id  product_id  created_at\n",
       "0    647746     2011564  2019-02-09\n",
       "1    906136     4105782  2019-11-23\n",
       "2  12862997     2144063  2019-07-16\n",
       "3  12097079     1207738  2019-04-05\n",
       "4   3184486     4278839  2019-03-08"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "df = pd.read_csv(\"purchase_history.csv\")\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "26fc8d6e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2174447"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1f528112",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>product_id</th>\n",
       "      <th>created_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>12862997</td>\n",
       "      <td>2144063</td>\n",
       "      <td>2019-07-16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>969122</th>\n",
       "      <td>12862997</td>\n",
       "      <td>2144063</td>\n",
       "      <td>2019-11-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1631287</th>\n",
       "      <td>12862997</td>\n",
       "      <td>2144063</td>\n",
       "      <td>2019-05-21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1890577</th>\n",
       "      <td>12862997</td>\n",
       "      <td>2144063</td>\n",
       "      <td>2019-11-05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1978805</th>\n",
       "      <td>12862997</td>\n",
       "      <td>2144063</td>\n",
       "      <td>2019-09-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          user_id  product_id  created_at\n",
       "2        12862997     2144063  2019-07-16\n",
       "969122   12862997     2144063  2019-11-02\n",
       "1631287  12862997     2144063  2019-05-21\n",
       "1890577  12862997     2144063  2019-11-05\n",
       "1978805  12862997     2144063  2019-09-07"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# show example of data with user_id\n",
    "df[df['user_id']==12862997]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "dcb2b344",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{1: '2019-01-01',\n",
       " 2: '2019-01-02',\n",
       " 3: '2019-01-03',\n",
       " 4: '2019-01-04',\n",
       " 5: '2019-01-05',\n",
       " 6: '2019-01-06',\n",
       " 7: '2019-01-07',\n",
       " 8: '2019-01-08',\n",
       " 9: '2019-01-09',\n",
       " 10: '2019-01-10',\n",
       " 11: '2019-01-11',\n",
       " 12: '2019-01-12',\n",
       " 13: '2019-01-13',\n",
       " 14: '2019-01-14',\n",
       " 15: '2019-01-15',\n",
       " 16: '2019-01-16',\n",
       " 17: '2019-01-17',\n",
       " 18: '2019-01-18',\n",
       " 19: '2019-01-19',\n",
       " 20: '2019-01-20',\n",
       " 21: '2019-01-21',\n",
       " 22: '2019-01-22',\n",
       " 23: '2019-01-23',\n",
       " 24: '2019-01-24',\n",
       " 25: '2019-01-25',\n",
       " 26: '2019-01-26',\n",
       " 27: '2019-01-27',\n",
       " 28: '2019-01-28',\n",
       " 29: '2019-01-29',\n",
       " 30: '2019-01-30',\n",
       " 31: '2019-01-31',\n",
       " 32: '2019-02-01',\n",
       " 33: '2019-02-02',\n",
       " 34: '2019-02-03',\n",
       " 35: '2019-02-04',\n",
       " 36: '2019-02-05',\n",
       " 37: '2019-02-06',\n",
       " 38: '2019-02-07',\n",
       " 39: '2019-02-08',\n",
       " 40: '2019-02-09',\n",
       " 41: '2019-02-10',\n",
       " 42: '2019-02-11',\n",
       " 43: '2019-02-12',\n",
       " 44: '2019-02-13',\n",
       " 45: '2019-02-14',\n",
       " 46: '2019-02-15',\n",
       " 47: '2019-02-16',\n",
       " 48: '2019-02-17',\n",
       " 49: '2019-02-18',\n",
       " 50: '2019-02-19',\n",
       " 51: '2019-02-20',\n",
       " 52: '2019-02-21',\n",
       " 53: '2019-02-22',\n",
       " 54: '2019-02-23',\n",
       " 55: '2019-02-24',\n",
       " 56: '2019-02-25',\n",
       " 57: '2019-02-26',\n",
       " 58: '2019-02-27',\n",
       " 59: '2019-02-28',\n",
       " 60: '2019-02-29',\n",
       " 61: '2019-02-30',\n",
       " 62: '2019-02-31',\n",
       " 63: '2019-03-01',\n",
       " 64: '2019-03-02',\n",
       " 65: '2019-03-03',\n",
       " 66: '2019-03-04',\n",
       " 67: '2019-03-05',\n",
       " 68: '2019-03-06',\n",
       " 69: '2019-03-07',\n",
       " 70: '2019-03-08',\n",
       " 71: '2019-03-09',\n",
       " 72: '2019-03-10',\n",
       " 73: '2019-03-11',\n",
       " 74: '2019-03-12',\n",
       " 75: '2019-03-13',\n",
       " 76: '2019-03-14',\n",
       " 77: '2019-03-15',\n",
       " 78: '2019-03-16',\n",
       " 79: '2019-03-17',\n",
       " 80: '2019-03-18',\n",
       " 81: '2019-03-19',\n",
       " 82: '2019-03-20',\n",
       " 83: '2019-03-21',\n",
       " 84: '2019-03-22',\n",
       " 85: '2019-03-23',\n",
       " 86: '2019-03-24',\n",
       " 87: '2019-03-25',\n",
       " 88: '2019-03-26',\n",
       " 89: '2019-03-27',\n",
       " 90: '2019-03-28',\n",
       " 91: '2019-03-29',\n",
       " 92: '2019-03-30',\n",
       " 93: '2019-03-31',\n",
       " 94: '2019-04-01',\n",
       " 95: '2019-04-02',\n",
       " 96: '2019-04-03',\n",
       " 97: '2019-04-04',\n",
       " 98: '2019-04-05',\n",
       " 99: '2019-04-06',\n",
       " 100: '2019-04-07',\n",
       " 101: '2019-04-08',\n",
       " 102: '2019-04-09',\n",
       " 103: '2019-04-10',\n",
       " 104: '2019-04-11',\n",
       " 105: '2019-04-12',\n",
       " 106: '2019-04-13',\n",
       " 107: '2019-04-14',\n",
       " 108: '2019-04-15',\n",
       " 109: '2019-04-16',\n",
       " 110: '2019-04-17',\n",
       " 111: '2019-04-18',\n",
       " 112: '2019-04-19',\n",
       " 113: '2019-04-20',\n",
       " 114: '2019-04-21',\n",
       " 115: '2019-04-22',\n",
       " 116: '2019-04-23',\n",
       " 117: '2019-04-24',\n",
       " 118: '2019-04-25',\n",
       " 119: '2019-04-26',\n",
       " 120: '2019-04-27',\n",
       " 121: '2019-04-28',\n",
       " 122: '2019-04-29',\n",
       " 123: '2019-04-30',\n",
       " 124: '2019-04-31',\n",
       " 125: '2019-05-01',\n",
       " 126: '2019-05-02',\n",
       " 127: '2019-05-03',\n",
       " 128: '2019-05-04',\n",
       " 129: '2019-05-05',\n",
       " 130: '2019-05-06',\n",
       " 131: '2019-05-07',\n",
       " 132: '2019-05-08',\n",
       " 133: '2019-05-09',\n",
       " 134: '2019-05-10',\n",
       " 135: '2019-05-11',\n",
       " 136: '2019-05-12',\n",
       " 137: '2019-05-13',\n",
       " 138: '2019-05-14',\n",
       " 139: '2019-05-15',\n",
       " 140: '2019-05-16',\n",
       " 141: '2019-05-17',\n",
       " 142: '2019-05-18',\n",
       " 143: '2019-05-19',\n",
       " 144: '2019-05-20',\n",
       " 145: '2019-05-21',\n",
       " 146: '2019-05-22',\n",
       " 147: '2019-05-23',\n",
       " 148: '2019-05-24',\n",
       " 149: '2019-05-25',\n",
       " 150: '2019-05-26',\n",
       " 151: '2019-05-27',\n",
       " 152: '2019-05-28',\n",
       " 153: '2019-05-29',\n",
       " 154: '2019-05-30',\n",
       " 155: '2019-05-31',\n",
       " 156: '2019-06-01',\n",
       " 157: '2019-06-02',\n",
       " 158: '2019-06-03',\n",
       " 159: '2019-06-04',\n",
       " 160: '2019-06-05',\n",
       " 161: '2019-06-06',\n",
       " 162: '2019-06-07',\n",
       " 163: '2019-06-08',\n",
       " 164: '2019-06-09',\n",
       " 165: '2019-06-10',\n",
       " 166: '2019-06-11',\n",
       " 167: '2019-06-12',\n",
       " 168: '2019-06-13',\n",
       " 169: '2019-06-14',\n",
       " 170: '2019-06-15',\n",
       " 171: '2019-06-16',\n",
       " 172: '2019-06-17',\n",
       " 173: '2019-06-18',\n",
       " 174: '2019-06-19',\n",
       " 175: '2019-06-20',\n",
       " 176: '2019-06-21',\n",
       " 177: '2019-06-22',\n",
       " 178: '2019-06-23',\n",
       " 179: '2019-06-24',\n",
       " 180: '2019-06-25',\n",
       " 181: '2019-06-26',\n",
       " 182: '2019-06-27',\n",
       " 183: '2019-06-28',\n",
       " 184: '2019-06-29',\n",
       " 185: '2019-06-30',\n",
       " 186: '2019-06-31',\n",
       " 187: '2019-07-01',\n",
       " 188: '2019-07-02',\n",
       " 189: '2019-07-03',\n",
       " 190: '2019-07-04',\n",
       " 191: '2019-07-05',\n",
       " 192: '2019-07-06',\n",
       " 193: '2019-07-07',\n",
       " 194: '2019-07-08',\n",
       " 195: '2019-07-09',\n",
       " 196: '2019-07-10',\n",
       " 197: '2019-07-11',\n",
       " 198: '2019-07-12',\n",
       " 199: '2019-07-13',\n",
       " 200: '2019-07-14',\n",
       " 201: '2019-07-15',\n",
       " 202: '2019-07-16',\n",
       " 203: '2019-07-17',\n",
       " 204: '2019-07-18',\n",
       " 205: '2019-07-19',\n",
       " 206: '2019-07-20',\n",
       " 207: '2019-07-21',\n",
       " 208: '2019-07-22',\n",
       " 209: '2019-07-23',\n",
       " 210: '2019-07-24',\n",
       " 211: '2019-07-25',\n",
       " 212: '2019-07-26',\n",
       " 213: '2019-07-27',\n",
       " 214: '2019-07-28',\n",
       " 215: '2019-07-29',\n",
       " 216: '2019-07-30',\n",
       " 217: '2019-07-31',\n",
       " 218: '2019-08-01',\n",
       " 219: '2019-08-02',\n",
       " 220: '2019-08-03',\n",
       " 221: '2019-08-04',\n",
       " 222: '2019-08-05',\n",
       " 223: '2019-08-06',\n",
       " 224: '2019-08-07',\n",
       " 225: '2019-08-08',\n",
       " 226: '2019-08-09',\n",
       " 227: '2019-08-10',\n",
       " 228: '2019-08-11',\n",
       " 229: '2019-08-12',\n",
       " 230: '2019-08-13',\n",
       " 231: '2019-08-14',\n",
       " 232: '2019-08-15',\n",
       " 233: '2019-08-16',\n",
       " 234: '2019-08-17',\n",
       " 235: '2019-08-18',\n",
       " 236: '2019-08-19',\n",
       " 237: '2019-08-20',\n",
       " 238: '2019-08-21',\n",
       " 239: '2019-08-22',\n",
       " 240: '2019-08-23',\n",
       " 241: '2019-08-24',\n",
       " 242: '2019-08-25',\n",
       " 243: '2019-08-26',\n",
       " 244: '2019-08-27',\n",
       " 245: '2019-08-28',\n",
       " 246: '2019-08-29',\n",
       " 247: '2019-08-30',\n",
       " 248: '2019-08-31',\n",
       " 249: '2019-09-01',\n",
       " 250: '2019-09-02',\n",
       " 251: '2019-09-03',\n",
       " 252: '2019-09-04',\n",
       " 253: '2019-09-05',\n",
       " 254: '2019-09-06',\n",
       " 255: '2019-09-07',\n",
       " 256: '2019-09-08',\n",
       " 257: '2019-09-09',\n",
       " 258: '2019-09-10',\n",
       " 259: '2019-09-11',\n",
       " 260: '2019-09-12',\n",
       " 261: '2019-09-13',\n",
       " 262: '2019-09-14',\n",
       " 263: '2019-09-15',\n",
       " 264: '2019-09-16',\n",
       " 265: '2019-09-17',\n",
       " 266: '2019-09-18',\n",
       " 267: '2019-09-19',\n",
       " 268: '2019-09-20',\n",
       " 269: '2019-09-21',\n",
       " 270: '2019-09-22',\n",
       " 271: '2019-09-23',\n",
       " 272: '2019-09-24',\n",
       " 273: '2019-09-25',\n",
       " 274: '2019-09-26',\n",
       " 275: '2019-09-27',\n",
       " 276: '2019-09-28',\n",
       " 277: '2019-09-29',\n",
       " 278: '2019-09-30',\n",
       " 279: '2019-09-31',\n",
       " 280: '2019-10-01',\n",
       " 281: '2019-10-02',\n",
       " 282: '2019-10-03',\n",
       " 283: '2019-10-04',\n",
       " 284: '2019-10-05',\n",
       " 285: '2019-10-06',\n",
       " 286: '2019-10-07',\n",
       " 287: '2019-10-08',\n",
       " 288: '2019-10-09',\n",
       " 289: '2019-10-10',\n",
       " 290: '2019-10-11',\n",
       " 291: '2019-10-12',\n",
       " 292: '2019-10-13',\n",
       " 293: '2019-10-14',\n",
       " 294: '2019-10-15',\n",
       " 295: '2019-10-16',\n",
       " 296: '2019-10-17',\n",
       " 297: '2019-10-18',\n",
       " 298: '2019-10-19',\n",
       " 299: '2019-10-20',\n",
       " 300: '2019-10-21',\n",
       " 301: '2019-10-22',\n",
       " 302: '2019-10-23',\n",
       " 303: '2019-10-24',\n",
       " 304: '2019-10-25',\n",
       " 305: '2019-10-26',\n",
       " 306: '2019-10-27',\n",
       " 307: '2019-10-28',\n",
       " 308: '2019-10-29',\n",
       " 309: '2019-10-30',\n",
       " 310: '2019-10-31',\n",
       " 311: '2019-11-01',\n",
       " 312: '2019-11-02',\n",
       " 313: '2019-11-03',\n",
       " 314: '2019-11-04',\n",
       " 315: '2019-11-05',\n",
       " 316: '2019-11-06',\n",
       " 317: '2019-11-07',\n",
       " 318: '2019-11-08',\n",
       " 319: '2019-11-09',\n",
       " 320: '2019-11-10',\n",
       " 321: '2019-11-11',\n",
       " 322: '2019-11-12',\n",
       " 323: '2019-11-13',\n",
       " 324: '2019-11-14',\n",
       " 325: '2019-11-15',\n",
       " 326: '2019-11-16',\n",
       " 327: '2019-11-17',\n",
       " 328: '2019-11-18',\n",
       " 329: '2019-11-19',\n",
       " 330: '2019-11-20',\n",
       " 331: '2019-11-21',\n",
       " 332: '2019-11-22',\n",
       " 333: '2019-11-23',\n",
       " 334: '2019-11-24',\n",
       " 335: '2019-11-25',\n",
       " 336: '2019-11-26',\n",
       " 337: '2019-11-27',\n",
       " 338: '2019-11-28',\n",
       " 339: '2019-11-29',\n",
       " 340: '2019-11-30',\n",
       " 341: '2019-11-31',\n",
       " 342: '2019-12-01',\n",
       " 343: '2019-12-02',\n",
       " 344: '2019-12-03',\n",
       " 345: '2019-12-04',\n",
       " 346: '2019-12-05',\n",
       " 347: '2019-12-06',\n",
       " 348: '2019-12-07',\n",
       " 349: '2019-12-08',\n",
       " 350: '2019-12-09',\n",
       " 351: '2019-12-10',\n",
       " 352: '2019-12-11',\n",
       " 353: '2019-12-12',\n",
       " 354: '2019-12-13',\n",
       " 355: '2019-12-14',\n",
       " 356: '2019-12-15',\n",
       " 357: '2019-12-16',\n",
       " 358: '2019-12-17',\n",
       " 359: '2019-12-18',\n",
       " 360: '2019-12-19',\n",
       " 361: '2019-12-20',\n",
       " 362: '2019-12-21',\n",
       " 363: '2019-12-22',\n",
       " 364: '2019-12-23',\n",
       " 365: '2019-12-24',\n",
       " 366: '2019-12-25',\n",
       " 367: '2019-12-26',\n",
       " 368: '2019-12-27',\n",
       " 369: '2019-12-28',\n",
       " 370: '2019-12-29',\n",
       " 371: '2019-12-30',\n",
       " 372: '2019-12-31',\n",
       " 373: '2020-01-01',\n",
       " 374: '2020-01-02',\n",
       " 375: '2020-01-03',\n",
       " 376: '2020-01-04',\n",
       " 377: '2020-01-05',\n",
       " 378: '2020-01-06',\n",
       " 379: '2020-01-07',\n",
       " 380: '2020-01-08',\n",
       " 381: '2020-01-09',\n",
       " 382: '2020-01-10',\n",
       " 383: '2020-01-11',\n",
       " 384: '2020-01-12',\n",
       " 385: '2020-01-13',\n",
       " 386: '2020-01-14',\n",
       " 387: '2020-01-15',\n",
       " 388: '2020-01-16',\n",
       " 389: '2020-01-17',\n",
       " 390: '2020-01-18',\n",
       " 391: '2020-01-19',\n",
       " 392: '2020-01-20',\n",
       " 393: '2020-01-21',\n",
       " 394: '2020-01-22',\n",
       " 395: '2020-01-23',\n",
       " 396: '2020-01-24',\n",
       " 397: '2020-01-25',\n",
       " 398: '2020-01-26',\n",
       " 399: '2020-01-27',\n",
       " 400: '2020-01-28',\n",
       " 401: '2020-01-29',\n",
       " 402: '2020-01-30',\n",
       " 403: '2020-01-31',\n",
       " 404: '2020-02-01',\n",
       " 405: '2020-02-02',\n",
       " 406: '2020-02-03',\n",
       " 407: '2020-02-04',\n",
       " 408: '2020-02-05',\n",
       " 409: '2020-02-06',\n",
       " 410: '2020-02-07',\n",
       " 411: '2020-02-08',\n",
       " 412: '2020-02-09',\n",
       " 413: '2020-02-10',\n",
       " 414: '2020-02-11',\n",
       " 415: '2020-02-12',\n",
       " 416: '2020-02-13',\n",
       " 417: '2020-02-14',\n",
       " 418: '2020-02-15',\n",
       " 419: '2020-02-16',\n",
       " 420: '2020-02-17',\n",
       " 421: '2020-02-18',\n",
       " 422: '2020-02-19',\n",
       " 423: '2020-02-20',\n",
       " 424: '2020-02-21',\n",
       " 425: '2020-02-22',\n",
       " 426: '2020-02-23',\n",
       " 427: '2020-02-24',\n",
       " 428: '2020-02-25',\n",
       " 429: '2020-02-26',\n",
       " 430: '2020-02-27',\n",
       " 431: '2020-02-28',\n",
       " 432: '2020-02-29',\n",
       " 433: '2020-02-30',\n",
       " 434: '2020-02-31',\n",
       " 435: '2020-03-01',\n",
       " 436: '2020-03-02',\n",
       " 437: '2020-03-03',\n",
       " 438: '2020-03-04',\n",
       " 439: '2020-03-05',\n",
       " 440: '2020-03-06',\n",
       " 441: '2020-03-07',\n",
       " 442: '2020-03-08',\n",
       " 443: '2020-03-09',\n",
       " 444: '2020-03-10',\n",
       " 445: '2020-03-11',\n",
       " 446: '2020-03-12',\n",
       " 447: '2020-03-13',\n",
       " 448: '2020-03-14',\n",
       " 449: '2020-03-15',\n",
       " 450: '2020-03-16',\n",
       " 451: '2020-03-17',\n",
       " 452: '2020-03-18',\n",
       " 453: '2020-03-19',\n",
       " 454: '2020-03-20',\n",
       " 455: '2020-03-21',\n",
       " 456: '2020-03-22',\n",
       " 457: '2020-03-23',\n",
       " 458: '2020-03-24',\n",
       " 459: '2020-03-25',\n",
       " 460: '2020-03-26',\n",
       " 461: '2020-03-27',\n",
       " 462: '2020-03-28',\n",
       " 463: '2020-03-29',\n",
       " 464: '2020-03-30',\n",
       " 465: '2020-03-31',\n",
       " 466: '2020-04-01',\n",
       " 467: '2020-04-02',\n",
       " 468: '2020-04-03',\n",
       " 469: '2020-04-04',\n",
       " 470: '2020-04-05',\n",
       " 471: '2020-04-06',\n",
       " 472: '2020-04-07',\n",
       " 473: '2020-04-08',\n",
       " 474: '2020-04-09',\n",
       " 475: '2020-04-10',\n",
       " 476: '2020-04-11',\n",
       " 477: '2020-04-12',\n",
       " 478: '2020-04-13',\n",
       " 479: '2020-04-14',\n",
       " 480: '2020-04-15',\n",
       " 481: '2020-04-16',\n",
       " 482: '2020-04-17',\n",
       " 483: '2020-04-18',\n",
       " 484: '2020-04-19',\n",
       " 485: '2020-04-20',\n",
       " 486: '2020-04-21',\n",
       " 487: '2020-04-22',\n",
       " 488: '2020-04-23',\n",
       " 489: '2020-04-24',\n",
       " 490: '2020-04-25',\n",
       " 491: '2020-04-26',\n",
       " 492: '2020-04-27',\n",
       " 493: '2020-04-28',\n",
       " 494: '2020-04-29',\n",
       " 495: '2020-04-30',\n",
       " 496: '2020-04-31',\n",
       " 497: '2020-05-01',\n",
       " 498: '2020-05-02',\n",
       " 499: '2020-05-03',\n",
       " 500: '2020-05-04',\n",
       " 501: '2020-05-05',\n",
       " 502: '2020-05-06',\n",
       " 503: '2020-05-07',\n",
       " 504: '2020-05-08',\n",
       " 505: '2020-05-09',\n",
       " 506: '2020-05-10',\n",
       " 507: '2020-05-11',\n",
       " 508: '2020-05-12',\n",
       " 509: '2020-05-13',\n",
       " 510: '2020-05-14',\n",
       " 511: '2020-05-15',\n",
       " 512: '2020-05-16',\n",
       " 513: '2020-05-17',\n",
       " 514: '2020-05-18',\n",
       " 515: '2020-05-19',\n",
       " 516: '2020-05-20',\n",
       " 517: '2020-05-21',\n",
       " 518: '2020-05-22',\n",
       " 519: '2020-05-23',\n",
       " 520: '2020-05-24',\n",
       " 521: '2020-05-25',\n",
       " 522: '2020-05-26',\n",
       " 523: '2020-05-27',\n",
       " 524: '2020-05-28',\n",
       " 525: '2020-05-29',\n",
       " 526: '2020-05-30',\n",
       " 527: '2020-05-31',\n",
       " 528: '2020-06-01',\n",
       " 529: '2020-06-02',\n",
       " 530: '2020-06-03',\n",
       " 531: '2020-06-04',\n",
       " 532: '2020-06-05',\n",
       " 533: '2020-06-06',\n",
       " 534: '2020-06-07',\n",
       " 535: '2020-06-08',\n",
       " 536: '2020-06-09',\n",
       " 537: '2020-06-10',\n",
       " 538: '2020-06-11',\n",
       " 539: '2020-06-12',\n",
       " 540: '2020-06-13',\n",
       " 541: '2020-06-14',\n",
       " 542: '2020-06-15',\n",
       " 543: '2020-06-16',\n",
       " 544: '2020-06-17',\n",
       " 545: '2020-06-18',\n",
       " 546: '2020-06-19',\n",
       " 547: '2020-06-20',\n",
       " 548: '2020-06-21',\n",
       " 549: '2020-06-22',\n",
       " 550: '2020-06-23',\n",
       " 551: '2020-06-24',\n",
       " 552: '2020-06-25',\n",
       " 553: '2020-06-26',\n",
       " 554: '2020-06-27',\n",
       " 555: '2020-06-28',\n",
       " 556: '2020-06-29',\n",
       " 557: '2020-06-30',\n",
       " 558: '2020-06-31',\n",
       " 559: '2020-07-01',\n",
       " 560: '2020-07-02',\n",
       " 561: '2020-07-03',\n",
       " 562: '2020-07-04',\n",
       " 563: '2020-07-05',\n",
       " 564: '2020-07-06',\n",
       " 565: '2020-07-07',\n",
       " 566: '2020-07-08',\n",
       " 567: '2020-07-09',\n",
       " 568: '2020-07-10',\n",
       " 569: '2020-07-11',\n",
       " 570: '2020-07-12',\n",
       " 571: '2020-07-13',\n",
       " 572: '2020-07-14',\n",
       " 573: '2020-07-15',\n",
       " 574: '2020-07-16',\n",
       " 575: '2020-07-17',\n",
       " 576: '2020-07-18',\n",
       " 577: '2020-07-19',\n",
       " 578: '2020-07-20',\n",
       " 579: '2020-07-21',\n",
       " 580: '2020-07-22',\n",
       " 581: '2020-07-23',\n",
       " 582: '2020-07-24',\n",
       " 583: '2020-07-25',\n",
       " 584: '2020-07-26',\n",
       " 585: '2020-07-27',\n",
       " 586: '2020-07-28',\n",
       " 587: '2020-07-29',\n",
       " 588: '2020-07-30',\n",
       " 589: '2020-07-31',\n",
       " 590: '2020-08-01',\n",
       " 591: '2020-08-02',\n",
       " 592: '2020-08-03',\n",
       " 593: '2020-08-04',\n",
       " 594: '2020-08-05',\n",
       " 595: '2020-08-06',\n",
       " 596: '2020-08-07',\n",
       " 597: '2020-08-08',\n",
       " 598: '2020-08-09',\n",
       " 599: '2020-08-10',\n",
       " 600: '2020-08-11',\n",
       " 601: '2020-08-12',\n",
       " 602: '2020-08-13',\n",
       " 603: '2020-08-14',\n",
       " 604: '2020-08-15',\n",
       " 605: '2020-08-16',\n",
       " 606: '2020-08-17',\n",
       " 607: '2020-08-18',\n",
       " 608: '2020-08-19',\n",
       " 609: '2020-08-20',\n",
       " 610: '2020-08-21',\n",
       " 611: '2020-08-22',\n",
       " 612: '2020-08-23',\n",
       " 613: '2020-08-24',\n",
       " 614: '2020-08-25',\n",
       " 615: '2020-08-26',\n",
       " 616: '2020-08-27',\n",
       " 617: '2020-08-28',\n",
       " 618: '2020-08-29',\n",
       " 619: '2020-08-30',\n",
       " 620: '2020-08-31',\n",
       " 621: '2020-09-01',\n",
       " 622: '2020-09-02',\n",
       " 623: '2020-09-03',\n",
       " 624: '2020-09-04',\n",
       " 625: '2020-09-05',\n",
       " 626: '2020-09-06',\n",
       " 627: '2020-09-07',\n",
       " 628: '2020-09-08',\n",
       " 629: '2020-09-09',\n",
       " 630: '2020-09-10',\n",
       " 631: '2020-09-11',\n",
       " 632: '2020-09-12',\n",
       " 633: '2020-09-13',\n",
       " 634: '2020-09-14',\n",
       " 635: '2020-09-15',\n",
       " 636: '2020-09-16',\n",
       " 637: '2020-09-17',\n",
       " 638: '2020-09-18',\n",
       " 639: '2020-09-19',\n",
       " 640: '2020-09-20',\n",
       " 641: '2020-09-21',\n",
       " 642: '2020-09-22',\n",
       " 643: '2020-09-23',\n",
       " 644: '2020-09-24',\n",
       " 645: '2020-09-25',\n",
       " 646: '2020-09-26',\n",
       " 647: '2020-09-27',\n",
       " 648: '2020-09-28',\n",
       " 649: '2020-09-29',\n",
       " 650: '2020-09-30',\n",
       " 651: '2020-09-31',\n",
       " 652: '2020-10-01',\n",
       " 653: '2020-10-02',\n",
       " 654: '2020-10-03',\n",
       " 655: '2020-10-04',\n",
       " 656: '2020-10-05',\n",
       " 657: '2020-10-06',\n",
       " 658: '2020-10-07',\n",
       " 659: '2020-10-08',\n",
       " 660: '2020-10-09',\n",
       " 661: '2020-10-10',\n",
       " 662: '2020-10-11',\n",
       " 663: '2020-10-12',\n",
       " 664: '2020-10-13',\n",
       " 665: '2020-10-14',\n",
       " 666: '2020-10-15',\n",
       " 667: '2020-10-16',\n",
       " 668: '2020-10-17',\n",
       " 669: '2020-10-18',\n",
       " 670: '2020-10-19',\n",
       " 671: '2020-10-20',\n",
       " 672: '2020-10-21',\n",
       " 673: '2020-10-22',\n",
       " 674: '2020-10-23',\n",
       " 675: '2020-10-24',\n",
       " 676: '2020-10-25',\n",
       " 677: '2020-10-26',\n",
       " 678: '2020-10-27',\n",
       " 679: '2020-10-28',\n",
       " 680: '2020-10-29',\n",
       " 681: '2020-10-30',\n",
       " 682: '2020-10-31',\n",
       " 683: '2020-11-01',\n",
       " 684: '2020-11-02',\n",
       " 685: '2020-11-03',\n",
       " 686: '2020-11-04',\n",
       " 687: '2020-11-05',\n",
       " 688: '2020-11-06',\n",
       " 689: '2020-11-07',\n",
       " 690: '2020-11-08',\n",
       " 691: '2020-11-09',\n",
       " 692: '2020-11-10',\n",
       " 693: '2020-11-11',\n",
       " 694: '2020-11-12',\n",
       " 695: '2020-11-13',\n",
       " 696: '2020-11-14',\n",
       " 697: '2020-11-15',\n",
       " 698: '2020-11-16',\n",
       " 699: '2020-11-17',\n",
       " 700: '2020-11-18',\n",
       " 701: '2020-11-19',\n",
       " 702: '2020-11-20',\n",
       " 703: '2020-11-21',\n",
       " 704: '2020-11-22',\n",
       " 705: '2020-11-23',\n",
       " 706: '2020-11-24',\n",
       " 707: '2020-11-25',\n",
       " 708: '2020-11-26',\n",
       " 709: '2020-11-27',\n",
       " 710: '2020-11-28',\n",
       " 711: '2020-11-29',\n",
       " 712: '2020-11-30',\n",
       " 713: '2020-11-31',\n",
       " 714: '2020-12-01',\n",
       " 715: '2020-12-02',\n",
       " 716: '2020-12-03',\n",
       " 717: '2020-12-04',\n",
       " 718: '2020-12-05',\n",
       " 719: '2020-12-06',\n",
       " 720: '2020-12-07',\n",
       " 721: '2020-12-08',\n",
       " 722: '2020-12-09',\n",
       " 723: '2020-12-10',\n",
       " 724: '2020-12-11',\n",
       " 725: '2020-12-12',\n",
       " 726: '2020-12-13',\n",
       " 727: '2020-12-14',\n",
       " 728: '2020-12-15',\n",
       " 729: '2020-12-16',\n",
       " 730: '2020-12-17',\n",
       " 731: '2020-12-18',\n",
       " 732: '2020-12-19',\n",
       " 733: '2020-12-20',\n",
       " 734: '2020-12-21',\n",
       " 735: '2020-12-22',\n",
       " 736: '2020-12-23',\n",
       " 737: '2020-12-24',\n",
       " 738: '2020-12-25',\n",
       " 739: '2020-12-26',\n",
       " 740: '2020-12-27',\n",
       " 741: '2020-12-28',\n",
       " 742: '2020-12-29',\n",
       " 743: '2020-12-30',\n",
       " 744: '2020-12-31'}"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def TokenizingDateTimes():\n",
    "    date_to_token = {}\n",
    "    token_to_date = {}\n",
    "    tknz = 1\n",
    "    for year in range(2019, 2021): # years create\n",
    "        for month in range(1, 13): # month create\n",
    "            for day in range(1, 32): # days create\n",
    "                if day<10 and month<10:\n",
    "                    date_to_token[f\"{year}-0{month}-0{day}\"] = tknz\n",
    "                    token_to_date[tknz] = f\"{year}-0{month}-0{day}\"\n",
    "                    tknz += 1\n",
    "                elif day<10 and month>=10:\n",
    "                    date_to_token[f\"{year}-{month}-0{day}\"] = tknz\n",
    "                    token_to_date[tknz] = f\"{year}-{month}-0{day}\"\n",
    "                    tknz += 1\n",
    "                elif day>=10 and month<10:\n",
    "                    date_to_token[f\"{year}-0{month}-{day}\"] = tknz\n",
    "                    token_to_date[tknz] = f\"{year}-0{month}-{day}\"\n",
    "                    tknz += 1\n",
    "                else:\n",
    "                    date_to_token[f\"{year}-{month}-{day}\"] = tknz\n",
    "                    token_to_date[tknz] = f\"{year}-{month}-{day}\"\n",
    "                    tknz += 1\n",
    "                    \n",
    "    return date_to_token, token_to_date        \n",
    "            \n",
    "        \n",
    "tokens_value, tokens_key = TokenizingDateTimes()   \n",
    "tokens_key"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "a4d5a792",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(20, '2019-01-20')"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#show example\n",
    "tokens_value['2019-01-20'], tokens_key[20]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "08d42934",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>product_id</th>\n",
       "      <th>created_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>860746</th>\n",
       "      <td>8672008</td>\n",
       "      <td>3890806</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1516796</th>\n",
       "      <td>750857</td>\n",
       "      <td>2198311</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>782386</th>\n",
       "      <td>6601315</td>\n",
       "      <td>987662</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018022</th>\n",
       "      <td>1060650</td>\n",
       "      <td>3356497</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>318411</th>\n",
       "      <td>1220553</td>\n",
       "      <td>898824</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         user_id  product_id  created_at\n",
       "860746   8672008     3890806           2\n",
       "1516796   750857     2198311           2\n",
       "782386   6601315      987662           2\n",
       "2018022  1060650     3356497           2\n",
       "318411   1220553      898824           2"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['created_at'] = df['created_at'].map(tokens_value)\n",
    "df.sort_values(by='created_at', inplace=True) # sort values to visulization better\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "23f385ee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# show example of data with user_id and product_id\n",
    "example = df[df['user_id']==3184486]\n",
    "example = example[example['product_id']==4278839]['created_at']\n",
    "indexes = [i for i in range(len(example))]\n",
    "plt.plot(indexes, example)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "5488e6d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "# we must split any user_id and product_id\n",
    "data_dict = {}\n",
    "for name, value in df.groupby(by=['user_id', 'product_id']):\n",
    "    data_dict[name] = sorted(list(set(value['created_at'].values)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "4fb02f54",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "([26, 31, 33, 41, 283, 289, 296, 308], [3, 26, 136, 148])"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# show examples\n",
    "data_dict[(577243, 968036)], data_dict[(577243, 968153)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "ab75a86e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# values must be the same length\n",
    "def MinimomLength(ln):\n",
    "    return min([len(i) for i in ln])\n",
    "\n",
    "chunke = MinimomLength(data_dict.values())\n",
    "chunke"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "e22c2e7e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((318050, 3), (318050,))"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x_train = []\n",
    "y_train = []\n",
    "for val in data_dict.values():\n",
    "    x_train.append(val[-chunke:-1])\n",
    "    y_train.append(val[-1])\n",
    "    \n",
    "x_train, y_train = np.array(x_train), np.array(y_train)\n",
    "x_train.shape, y_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d3aacf2d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8018710245072824"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from sklearn.tree import DecisionTreeRegressor\n",
    "from sklearn.neighbors import KNeighborsRegressor\n",
    "from sklearn.metrics import mean_squared_error\n",
    "\n",
    "# for Linear Regression\n",
    "model = LinearRegression(n_jobs=10)\n",
    "model.fit(x_train, y_train)\n",
    "model.score(x_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "8b82fa31",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9501507033210249"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# for Random Forest Regressor\n",
    "model = RandomForestRegressor(n_jobs=10, n_estimators=100,)\n",
    "model.fit(x_train, y_train)\n",
    "model.score(x_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "bea6a4ce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9737711299520847"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# for Decision Tree Regressor\n",
    "model = DecisionTreeRegressor()\n",
    "model.fit(x_train, y_train)\n",
    "model.score(x_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "70b738a9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.859380845219555"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# for K Neighbors Regressor\n",
    "model = KNeighborsRegressor(n_jobs=10, n_neighbors=4)\n",
    "model.fit(x_train, y_train)\n",
    "model.score(x_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "67d1d364",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[19, 44, 106, 171]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_dict[(577243, 875550)] # target is 171"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "7db00cd8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([171.])"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# example predictions\n",
    "x_test = np.array([19, 44, 106]) \n",
    "pred = model.predict(x_test.reshape(1, -1))\n",
    "pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8bbff0f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'2019-06-16'"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tokens_key[int(pred)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "fee850cf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([229.])"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# predict future\n",
    "x_future = np.array([44, 106, 171]) \n",
    "forcast = model.predict(x_future.reshape(1, -1))\n",
    "forcast"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "b0583e6e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'2019-08-12'"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tokens_key[int(forcast)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5d909831",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
